<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S90T45U795">sigma_u0</span> = giveSigma(<span class="var type1" id="S91T45U798">grad_u0</span>,<span class="var type1" id="S92T2U799">Mu</span>,<span class="var type1" id="S93T2U800">Lambda</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line"><span class="comment">%     fun = @(block_struct) Lambda*trace(block_struct.data)*eye(2) + Mu*(block_struct.data+block_struct.data') +<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line"><span class="comment">%                                             0.5*Lambda*trace(block_struct.data'*block_struct.data)*eye(2) + Mu*(block_struct.data'*block_struct.data);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line"><span class="comment">%     sigma_u0 = blockproc(grad_u0,[2 2],fun);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">    <span class="mxinfo" id="T14:U5"><span class="var type1" id="S94T14U803">N</span> = <span class="mxinfo" id="T14:U7">size(<span class="var type1" id="S91T45U806">grad_u0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">    <span class="mxinfo" id="T45:U9"><span class="var type1" id="S90T45U809">sigma_u0</span> = <span class="mxinfo" id="T45:U11">zeros(<span class="var type1" id="S94T14U812">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S97T2U815">i</span>=<span class="mxinfo" id="T2:U14">1</span>:<span class="mxinfo" id="T2:U15"><span class="mxinfo" id="T2:U16">1/2</span>*<span class="mxinfo" id="T2:U17"><span class="var type1" id="S94T14U823">N</span>(<span class="mxinfo" id="T2:U19">1</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S98T2U827">j</span>=<span class="mxinfo" id="T2:U21">1</span>:<span class="mxinfo" id="T2:U22"><span class="mxinfo" id="T2:U23">1/2</span>*<span class="mxinfo" id="T2:U24"><span class="var type1" id="S94T14U835">N</span>(<span class="mxinfo" id="T2:U26">2</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">             <span class="mxinfo" id="T12:U27"><span class="var type1" id="S99T12U839">E</span> = <span class="mxinfo" id="T12:U29"><span class="mxinfo" id="T2:U30">0.5</span>*( <span class="mxinfo" id="T12:U31"><span class="mxinfo" id="T12:U32"><span class="mxinfo" id="T12:U33"><span class="var type1" id="S91T45U846">grad_u0</span>(<span class="mxinfo" id="T49:U35"><span class="mxinfo" id="T2:U36"><span class="mxinfo" id="T2:U37"><span class="mxinfo" id="T2:U38">2</span>*<span class="var type1" id="S97T2U851">i</span></span>-1</span>:<span class="mxinfo" id="T2:U40"><span class="mxinfo" id="T2:U41">2</span>*<span class="var type1" id="S97T2U855">i</span></span></span>,<span class="mxinfo" id="T49:U43"><span class="mxinfo" id="T2:U44"><span class="mxinfo" id="T2:U45">2</span>*<span class="var type1" id="S98T2U860">j</span>-1</span>:<span class="mxinfo" id="T2:U47">2</span>*<span class="var type1" id="S98T2U864">j</span></span>)</span> + <span class="mxinfo" id="T12:U49"><span class="mxinfo" id="T12:U50"><span class="var type1" id="S91T45U867">grad_u0</span>(<span class="mxinfo" id="T49:U52"><span class="mxinfo" id="T2:U53"><span class="mxinfo" id="T2:U54"><span class="mxinfo" id="T2:U55">2</span>*<span class="var type1" id="S97T2U872">i</span></span>-1</span>:<span class="mxinfo" id="T2:U57"><span class="mxinfo" id="T2:U58">2</span>*<span class="var type1" id="S97T2U876">i</span></span></span>,<span class="mxinfo" id="T49:U60"><span class="mxinfo" id="T2:U61"><span class="mxinfo" id="T2:U62">2</span>*<span class="var type1" id="S98T2U881">j</span>-1</span>:<span class="mxinfo" id="T2:U64">2</span>*<span class="var type1" id="S98T2U885">j</span></span>)</span>'</span></span> + <span class="mxinfo" id="T12:U66"><span class="mxinfo" id="T12:U67"><span class="mxinfo" id="T12:U68"><span class="var type1" id="S91T45U889">grad_u0</span>(<span class="mxinfo" id="T49:U70"><span class="mxinfo" id="T2:U71"><span class="mxinfo" id="T2:U72"><span class="mxinfo" id="T2:U73">2</span>*<span class="var type1" id="S97T2U894">i</span></span>-1</span>:<span class="mxinfo" id="T2:U75"><span class="mxinfo" id="T2:U76">2</span>*<span class="var type1" id="S97T2U898">i</span></span></span>,<span class="mxinfo" id="T49:U78"><span class="mxinfo" id="T2:U79"><span class="mxinfo" id="T2:U80">2</span>*<span class="var type1" id="S98T2U903">j</span>-1</span>:<span class="mxinfo" id="T2:U82">2</span>*<span class="var type1" id="S98T2U907">j</span></span>)</span>'</span>*<span class="mxinfo" id="T12:U84"><span class="var type1" id="S91T45U909">grad_u0</span>(<span class="mxinfo" id="T49:U86"><span class="mxinfo" id="T2:U87"><span class="mxinfo" id="T2:U88"><span class="mxinfo" id="T2:U89">2</span>*<span class="var type1" id="S97T2U914">i</span></span>-1</span>:<span class="mxinfo" id="T2:U91"><span class="mxinfo" id="T2:U92">2</span>*<span class="var type1" id="S97T2U918">i</span></span></span>,<span class="mxinfo" id="T49:U94"><span class="mxinfo" id="T2:U95"><span class="mxinfo" id="T2:U96">2</span>*<span class="var type1" id="S98T2U923">j</span>-1</span>:<span class="mxinfo" id="T2:U98">2</span>*<span class="var type1" id="S98T2U927">j</span></span>)</span></span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">            <span class="mxinfo" id="T12:U100"><span class="mxinfo" id="T12:U101"><span class="var type1" id="S90T45U931">sigma_u0</span>(<span class="mxinfo" id="T49:U103"><span class="mxinfo" id="T2:U104"><span class="mxinfo" id="T2:U105"><span class="mxinfo" id="T2:U106">2</span>*<span class="var type1" id="S97T2U936">i</span></span>-1</span>:<span class="mxinfo" id="T2:U108"><span class="mxinfo" id="T2:U109">2</span>*<span class="var type1" id="S97T2U940">i</span></span></span>,<span class="mxinfo" id="T49:U111"><span class="mxinfo" id="T2:U112"><span class="mxinfo" id="T2:U113">2</span>*<span class="var type1" id="S98T2U945">j</span>-1</span>:<span class="mxinfo" id="T2:U115">2</span>*<span class="var type1" id="S98T2U949">j</span></span>)</span> = <span class="mxinfo" id="T12:U117"><span class="mxinfo" id="T12:U118"><span class="mxinfo" id="T2:U119"><span class="var type1" id="S93T2U953">Lambda</span>*<span class="mxinfo" id="T2:U121">trace(<span class="var type1" id="S99T12U956">E</span>)</span></span>*<span class="mxinfo" id="T12:U123">eye(2)</span></span> + <span class="mxinfo" id="T12:U124"><span class="mxinfo" id="T2:U125"><span class="mxinfo" id="T2:U126">2</span>*<span class="var type1" id="S92T2U963">Mu</span></span>*(<span class="var type1" id="S99T12U965">E</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">                                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"></span></span>
</pre>
