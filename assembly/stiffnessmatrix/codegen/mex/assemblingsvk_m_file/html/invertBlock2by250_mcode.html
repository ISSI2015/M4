<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,255" id="srcline255">255</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,256" id="srcline256">256</a></span><span class="line"><span class="comment">% function matOut = assemble2by2Blocks(mat)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,257" id="srcline257">257</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,258" id="srcline258">258</a></span><span class="line"><span class="comment">%     N = size(mat);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,259" id="srcline259">259</a></span><span class="line"><span class="comment">%     matOut = zeros(1/2*N);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,260" id="srcline260">260</a></span><span class="line"><span class="comment">%     </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,261" id="srcline261">261</a></span><span class="line"><span class="comment">%     for i=1:1/4*N(1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,262" id="srcline262">262</a></span><span class="line"><span class="comment">%         for j=1:1/4*N(2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,263" id="srcline263">263</a></span><span class="line"><span class="comment">%             matOut(2*i-1:2*i,2*j-1:2*j) = [ trace(mat(4*i-3:4*i-2 , 4*j-3:4*j-2)) trace(mat(4*i-1:4*i , 4*j-3:4*j-2)) ; trace(mat( 4*i-3:4*i-2, 4*j-1:4*j)) trace(mat(4*i-1:4*i , 4*j-1:4*j)) ]';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,264" id="srcline264">264</a></span><span class="line"><span class="comment">%         end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,265" id="srcline265">265</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,266" id="srcline266">266</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,267" id="srcline267">267</a></span><span class="line"><span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,268" id="srcline268">268</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,269" id="srcline269">269</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S184T12U1624">mat</span> = invertBlock2by2(<span class="mxinfo" id="T12:U2"><span class="mxinfo" id="T12:U3"><span class="var type1" id="S184T12U1627">mat</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,270" id="srcline270">270</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,271" id="srcline271">271</a></span><span class="line">    <span class="mxinfo" id="T14:U5"><span class="var type1" id="S185T14U1630">N</span> = <span class="mxinfo" id="T14:U7">size(<span class="var type1" id="S184T12U1633">mat</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,272" id="srcline272">272</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,273" id="srcline273">273</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S187T2U1636">i</span>=<span class="mxinfo" id="T2:U10">1:1/2*<span class="var type1" id="S185T14U1644">N</span>(1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,274" id="srcline274">274</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S188T2U1648">j</span>=<span class="mxinfo" id="T2:U13">1:1/2*<span class="var type1" id="S185T14U1656">N</span>(2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,275" id="srcline275">275</a></span><span class="line">            <span class="mxinfo" id="T12:U15"><span class="mxinfo" id="T12:U16"><span class="var type1" id="S184T12U1661">mat</span>(<span class="mxinfo" id="T14:U18"><span class="mxinfo" id="T2:U19">2*<span class="var type1" id="S187T2U1666">i</span>-1</span>:<span class="mxinfo" id="T2:U21">2*<span class="var type1" id="S187T2U1670">i</span></span></span>,<span class="mxinfo" id="T14:U23"><span class="mxinfo" id="T2:U24">2*<span class="var type1" id="S188T2U1675">j</span>-1</span>:<span class="mxinfo" id="T2:U26">2*<span class="var type1" id="S188T2U1679">j</span></span></span>)</span> = <span class="mxinfo" id="T12:U28"><span class="mxinfo" id="T12:U29"><span class="var type1" id="S184T12U1682">mat</span>(<span class="mxinfo" id="T14:U31"><span class="mxinfo" id="T2:U32">2*<span class="var type1" id="S187T2U1687">i</span>-1</span>:<span class="mxinfo" id="T2:U34">2*<span class="var type1" id="S187T2U1691">i</span></span></span>,<span class="mxinfo" id="T14:U36"><span class="mxinfo" id="T2:U37">2*<span class="var type1" id="S188T2U1696">j</span>-1</span>:<span class="mxinfo" id="T2:U39">2*<span class="var type1" id="S188T2U1700">j</span></span></span>)</span>\<span class="mxinfo" id="T12:U41">eye(2)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,276" id="srcline276">276</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,277" id="srcline277">277</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,278" id="srcline278">278</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,279" id="srcline279">279</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,280" id="srcline280">280</a></span><span class="line"></span></span>
</pre>
